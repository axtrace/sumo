# Telegram Chat Summary Bot

[Sumo](https://t.me/sumo25_bot) - –ë–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ —á–∞—Ç–æ–≤ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏—Å—Ç–æ—Ä–∏–∏ –≤ Yandex Database (YDB) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º YandexGPT –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫—Ä–∞—Ç–∫–∏—Ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–π.

## üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –≤ YDB
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫—Ä–∞—Ç–∫–∏–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è —á–∞—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é YandexGPT
- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º –±–æ—Ç–∞ (`@botname /summary`)
- –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –≤ –ª–∏—á–Ω—ã—Ö —á–∞—Ç–∞—Ö, —Ç–∞–∫ –∏ –≤ –≥—Ä—É–ø–ø–∞—Ö

## ‚öôÔ∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Yandex Cloud Functions** - —Ö–æ—Å—Ç–∏–Ω–≥ –±–æ—Ç–∞
- **Yandex Database (YDB)** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **YandexGPT** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–º–º–∞—Ä–∏
- **pyTelegramBotAPI** - —Ä–∞–±–æ—Ç–∞ —Å Telegram API
- **GitHub Actions** - CI/CD

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ê–∫–∫–∞—É–Ω—Ç –≤ [Yandex Cloud](https://yandex.cloud/ru)
- Telegram –±–æ—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
- –î–æ—Å—Ç—É–ø –∫ Yandex Database

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```text
PRODUCTION_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
FOLDER_ID=–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä_–∫–∞—Ç–∞–ª–æ–≥–∞_YC
API_KEY=API-–∫–ª—é—á_–¥–ª—è_YandexGPT
YDB_ENDPOINT=grpcs://ydb.serverless.yandexcloud.net:2135
YDB_DATABASE=/ru-central1/.../... 
```

### 2. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Yandex Cloud Functions

#### –í–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [YC CLI](https://yandex.cloud/ru/docs/cli/)

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å:
```bash
yc init
```
3. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é:

```bash
yc serverless function create --name=sumo-bot
yc serverless function version create \
  --function-name=sumo-bot \
  --runtime python312 \
  --entrypoint main.handler \
  --memory 256m \
  --execution-timeout 10s \
  --source-path . \
  --environment "PRODUCTION_TOKEN=$PRODUCTION_TOKEN,FOLDER_ID=$FOLDER_ID,API_KEY=$API_KEY,YDB_ENDPOINT=$YDB_ENDPOINT,YDB_DATABASE=$YDB_DATABASE"
```

4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```bash
curl -F "url=https://functions.yandexcloud.net/–≤–∞—à–∞_—Ñ—É–Ω–∫—Ü–∏—è" \
  "https://api.telegram.org/bot$PRODUCTION_TOKEN/setWebhook"
```

#### –í–∞—Ä–∏–∞–Ω—Ç —á–µ—Ä–µ–∑ UI-–∫–æ–Ω—Å–æ–ª—å
–í [–∫–æ–Ω—Å–æ–ª–∏](https://console.cloud.yandex.ru):
1. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏ –≤—ã–¥–∞–π—Ç–µ –µ–º—É –ø—Ä–∞–≤–∞ editor –≤ ydb –∏ –ø—Ä–∞–≤–∞ invoker –≤ functions
1. –°–æ–∑–¥–∞–π—Ç–µ Cloud Function –∏ —É–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–µ–º–µ–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –Ω–µ—ë –∏–∑ —Å–ø–∏—Å–∫–∞:
   ```text
      PRODUCTION_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
      FOLDER_ID=–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä_–∫–∞—Ç–∞–ª–æ–≥–∞_YC
      API_KEY=API-–∫–ª—é—á_–¥–ª—è_YandexGPT
      YDB_ENDPOINT=grpcs://ydb.serverless.yandexcloud.net:2135
      YDB_DATABASE=/ru-central1/.../... 
    ```
3. –ü—Ä–∏–≤—è–∂–∏—Ç–µ –∫ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ
   
   –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–∏–Ω–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ github actions

## üõ† –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

- `/summary` –∏–ª–∏ `/summarize` - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —á–∞—Ç–∞. –¢–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ @botname /summary

## üìä –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. –ë–æ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ YDB
2. –ü–æ –∫–æ–º–∞–Ω–¥–µ /summary:
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏–º–∏—Ç—ã –≤—ã–∑–æ–≤–æ–≤ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏–π –∏–∑ YDB
- –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ YDB —Å –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏, –µ—Å–ª–∏ –æ–Ω–∞ –±—ã–ª–∞
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç –¥–ª—è YandexGPT
- –ü–æ–ª—É—á–∞–µ—Ç —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –æ—Ç YandexGPT
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∞–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –≤ –∏—Å—Ç–æ—Ä–∏—é

## ü§ñ –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã
```makefile
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /summary
–ë–æ—Ç: üìù –ö—Ä–∞—Ç–∫–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:

‚Ä¢ –û–±—Å—É–∂–¥–∞–ª–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –±–æ—Ç–∞ —Å YDB
‚Ä¢ –†–µ—à–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Python 3.12
‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –ù–∞–º–µ—Ç–∏–ª–∏ –ø–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
MIT License. –°–º. —Ñ–∞–π–ª LICENSE.

–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è Yandex Cloud. –ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –∞–≤—Ç–æ—Ä—É.
